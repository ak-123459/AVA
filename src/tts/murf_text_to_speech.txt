from .tts_interface import TTSInterface
impot requests
from murf import Murf
import os





class Murf_tts_api(TTSInterface):

    
  def __init__(self,**kwargs):
      
      self.api_key = kwargs.get("MURF_STT_API_KEY")
    
      self.murf_client = Murf(api_key = self.api_key)

      self.voice_id = kwargs.get("voice_id","hi-IN-kabir")

      self.format = kwargs.get("format","WAV")

      self.sample_rate = kwargs.get("sample_rate",44100)
      


  
  async def  synthesise_stream_audio(self,text:str,client):


     res = self.murf_client.text_to_speech.stream(

     text= text,

     voice_id= self.voice_id,    format = self.format, sample_rate =self.sample_rate )

    
     print("[tts] received streaming object..")

     
     return res





  async def speech_synthesis(self,text:str,client):


    res = self.murf_client.text_to_speech.generate(text= text,  voice_id=self.voice_id, format = self.format, sample_rate =self.sample_rate)
    
    
    url = res.audio_file
    
    file_name =  client.get_file_name()


    r = requests.get(url)


    if(r.status_code==200):  
  
    
      with open( file_name, 'wb') as f:

         f.write(r.content)
        
      print("text to speech completed.")   
    
    else:
    
      print("murf source audio file not found")

   
    os.remove(file_name)
   
   
  






           